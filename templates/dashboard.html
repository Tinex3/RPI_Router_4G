{% extends "base.html" %}
{% block title %}Dashboard - EC25 Router{% endblock %}
{% block page_title %}Dashboard{% endblock %}

{% block content %}
<!-- Info del Sistema -->
<div class="card mb-2">
  <h2>
    <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:24px;height:24px;">
      <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
      <line x1="8" y1="21" x2="16" y2="21"></line>
      <line x1="12" y1="17" x2="12" y2="21"></line>
    </svg>
    Estado del Sistema
  </h2>
  <div class="system-stats">
    <div class="stat-item">
      <div id="sysUptime" class="stat-value">--</div>
      <div class="stat-label">Uptime</div>
    </div>
    <div class="stat-item">
      <div id="sysCPU" class="stat-value">--</div>
      <div class="stat-label">Temperatura</div>
    </div>
    <div class="stat-item">
      <div id="sysMemory" class="stat-value">--%</div>
      <div class="stat-label">Memoria</div>
    </div>
    <div class="stat-item">
      <div id="sysDisk" class="stat-value">--%</div>
      <div class="stat-label">Disco</div>
    </div>
  </div>
</div>

<div class="grid">
  <div class="card">
    <h2>ğŸŒ WAN</h2>
    <div id="wanStatus" class="status-badge">â€“</div>
    <div class="row" style="margin-top: 16px;">
      <select id="wanMode" class="input">
        <option value="auto">ğŸ”„ Auto</option>
        <option value="eth">ğŸ”Œ Ethernet</option>
        <option value="lte">ğŸ“¡ LTE</option>
      </select>
      <button class="btn" onclick="saveWan()">Guardar</button>
    </div>
  </div>

  <div class="card">
    <h2>ğŸ“¶ SeÃ±al</h2>
    <div id="signalStrength" class="signal-meter"></div>
    <div id="signalDetails" class="info-list">
      <div class="info-item">
        <span class="label tooltip-trigger">
          CSQ:
          <span class="tooltip">
            <strong>Channel Signal Quality</strong><br>
            Calidad bÃ¡sica de seÃ±al 2G/3G<br>
            ğŸ“Š Valores: 0-31 (mejor &gt; 20)<br>
            ğŸ“ En dBm: -113 a -51 dBm
          </span>
        </span>
        <span id="csq" class="value">â€“</span>
      </div>
      <div class="info-item" style="border: none; padding-bottom: 0;">
        <span class="label" style="color: var(--primary); font-weight: 600;">MÃ©tricas LTE:</span>
      </div>
      <div class="info-item metric-detail">
        <span class="label tooltip-trigger">
          RSRP:
          <span class="tooltip">
            <strong>Reference Signal Received Power</strong><br>
            Potencia de la seÃ±al LTE recibida<br>
            âœ… Excelente: &gt; -80 dBm<br>
            ğŸŸ¢ Buena: -80 a -90 dBm<br>
            ğŸŸ¡ Regular: -90 a -100 dBm<br>
            ğŸŸ  DÃ©bil: -100 a -110 dBm<br>
            ğŸ”´ Muy dÃ©bil: &lt; -110 dBm
          </span>
        </span>
        <span id="rsrp" class="value">â€“</span>
      </div>
      <div class="info-item metric-detail">
        <span class="label tooltip-trigger">
          RSRQ:
          <span class="tooltip">
            <strong>Reference Signal Received Quality</strong><br>
            Calidad de seÃ±al (interferencias)<br>
            âœ… Excelente: &gt; -10 dB<br>
            ğŸŸ¢ Buena: -10 a -15 dB<br>
            ğŸŸ¡ Regular: -15 a -20 dB<br>
            ğŸ”´ Mala: &lt; -20 dB
          </span>
        </span>
        <span id="rsrq" class="value">â€“</span>
      </div>
      <div class="info-item metric-detail">
        <span class="label tooltip-trigger">
          SINR:
          <span class="tooltip">
            <strong>Signal to Interference + Noise Ratio</strong><br>
            RelaciÃ³n seÃ±al/ruido+interferencia<br>
            âœ… Excelente: &gt; 20 dB<br>
            ğŸŸ¢ Buena: 13 a 20 dB<br>
            ğŸŸ¡ Regular: 0 a 13 dB<br>
            ğŸ”´ Mala: &lt; 0 dB
          </span>
        </span>
        <span id="sinr" class="value">â€“</span>
      </div>
    </div>
  </div>

  <div class="card">
    <h2>ğŸ“± MÃ³dem</h2>
    <div id="modemInfo" class="info-list">
      <div class="info-item">
        <span class="label">Operador:</span>
        <span id="operator" class="value">â€“</span>
      </div>
      <div class="info-item">
        <span class="label tooltip-trigger">
          Red:
          <span class="tooltip tooltip-left">
            <strong>TecnologÃ­a y Banda</strong><br>
            FDD = Frequency Division Duplex<br>
            (subida y bajada en frecuencias separadas)<br><br>
            Banda 7 @ 2600 MHz (AmÃ©rica Latina)<br>
            Banda 3 @ 1800 MHz (comÃºn en ciudades)<br>
            Banda 28 @ 700 MHz (cobertura rural)
          </span>
        </span>
        <span id="network" class="value">â€“</span>
      </div>
      <div class="info-item">
        <span class="label">Estado:</span>
        <span id="registration" class="value">â€“</span>
      </div>
      <div class="info-item">
        <span class="label">SIM:</span>
        <span id="sim" class="value">â€“</span>
      </div>
    </div>
    <button class="btn danger" onclick="resetModem()" style="margin-top: 16px; width: 100%;">ğŸ”„ Reiniciar MÃ³dem</button>
  </div>

  <div class="card">
    <h2>âš¡ Velocidad</h2>
    <div id="speedtestResult" style="display:none;">
      <div class="info-list">
        <div class="info-item">
          <span class="label">ğŸ“¥ Descarga:</span>
          <span id="downloadSpeed" class="value speed-value">â€“</span>
        </div>
        <div class="info-item">
          <span class="label">ğŸ“¤ Subida:</span>
          <span id="uploadSpeed" class="value speed-value">â€“</span>
        </div>
        <div class="info-item">
          <span class="label">â±ï¸ Ping:</span>
          <span id="pingValue" class="value">â€“</span>
        </div>
        <div class="info-item" style="border:none;">
          <span class="label">ğŸŒ Servidor:</span>
          <span id="serverInfo" class="value" style="font-size:.85rem;">â€“</span>
        </div>
      </div>
    </div>
    <div id="speedtestStatus" style="text-align:center; color:var(--muted); margin:20px 0;">
      Presiona el botÃ³n para iniciar
    </div>
    <button id="speedtestBtn" class="btn" onclick="runSpeedtest()" style="width: 100%;">ğŸš€ Iniciar Test</button>
  </div>
</div>

<script src="/static/js/dashboard.js"></script>
{% endblock %}
